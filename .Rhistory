# Load Required Packages: to be increased over the course
requiredPackages <- c("car","knitr","FactoMineR","missMDA","mvoutlier","chemometrics")
missingPackages <- requiredPackages[!(requiredPackages %in% installed.packages()[,"Package"])]
if(length(missingPackages)) install.packages(missingPackages)
setwd("C:/Users/Sergio/Dropbox/UPC/FIB/Analisis de datos y explotacion de la informacion (ADEI)/FIB-ADEI-Big-Data-Analysis")
load("set-datos.RData", envir = parent.frame(), verbose = FALSE)
#setwd("C:/Users/Sergio/Dropbox/UPC/FIB/Analisis de datos y explotacion de la informacion (ADEI)/FIB-ADEI-Big-Data-Analysis")
setwd("C:/Users/GUILLEM/Documents/ADEI/FIB-ADEI-Big-Data-Analysis")
load("set-datos.RData", envir = parent.frame(), verbose = FALSE)
#setwd("C:/Users/Sergio/Dropbox/UPC/FIB/Analisis de datos y explotacion de la informacion (ADEI)/FIB-ADEI-Big-Data-Analysis")
setwd("C:/Users/GUILLEM/Documents/ADEI/FIB-ADEI-Big-Data-Analysis")
#setwd("C:/Users/Sergio/Dropbox/UPC/FIB/Analisis de datos y explotacion de la informacion (ADEI)/FIB-ADEI-Big-Data-Analysis")
setwd("C:/Users/GUILLEM/Documents/ADEI/FIB-ADEI-Big-Data-Analysis")
#setwd("C:/Users/Sergio/Dropbox/UPC/FIB/Analisis de datos y explotacion de la informacion (ADEI)/FIB-ADEI-Big-Data-Analysis")
setwd("C:/Users/GUILLEM/Documents/ADEI/FIB-ADEI-Big-Data-Analysis")
#setwd("C:/Users/Sergio/Dropbox/UPC/FIB/Analisis de datos y explotacion de la informacion (ADEI)/FIB-ADEI-Big-Data-Analysis")
#setwd("C:/Users/GUILLEM/Documents/ADEI/FIB-ADEI-Big-Data-Analysis")
setwd("C:/Users/usuario/Documents/ADEI/FIB-ADEI-Big-Data-Analysis")
load("set-datos.RData", envir = parent.frame(), verbose = FALSE)
#Comprobar el tamaño de la muestra
dim(df)
# Graphics
names(df)
# Overview of data frame
summary(df)
#######################GUILLEM:
#Separamos variables target/no-target numéricas/categóricas (observamos un individuo cualquiera)
df[1,]
aux <- c(1,11:14,16:20)
vars_num<-names(df)[aux];vars_num
vars_cat<-names(df)[-aux];vars_cat
vars_target<-names(df)[c(11,21)];vars_target
#Analizamos variables según si son cat/num o target/no-target (obtenemos 4 clasificaciones)
#target+categorica (miramos qué nivles tiene)
levels(df$y) #solo hay yes/no no hay que hacer nada
#target+numerica (miramos qué valores toma)
summary(df$duration)#Vemos que hay valores muy pequeños, incluso 0, tambien de muy grandes.
hist(df$duration,100) #Miramos distribución
boxplot(df$duration) #Hacemos boxplot para ver outliers
calcQ <- function(x) {# Some useful functions
s.x <- summary(x)
iqr<-s.x[5]-s.x[2]
list(souti=s.x[2]-3*iqr, mouti=s.x[2]-1.5*iqr, min=s.x[1], q1=s.x[2], q2=s.x[3],
q3=s.x[5], max=s.x[6], mouts=s.x[5]+1.5*iqr, souts=s.x[5]+3*iqr ) }
out.var<-calcQ(df$duration);out.var
abline(h=650,col="red",lwd=2) #Fijamos límite soft
abline(h=979,col="magenta",lwd=2) #Fijamos límite extreme
aux<-order(df$duration,decreasing=TRUE)[1:10];df[aux,'duration'] #Hechamos un ojo a los 10 valores más extremos
df<-df[-aux[1:6],]#decidimos eliminamos los 6 elementos más extremos
boxplot(df$duration) #Hacemos boxplot de nuevo
aux<-which(df$duration<5);length(aux);df[aux,'duration']#Ahora miramos los que son inferiores a 5s (no puede considerarse llamada)
df<-df[-aux,]#decidimos eliminarlos todos
#no-target+categorica
for(i in vars_cat){
cat("################ ",i," ##################\n")
print(summary(df[,i]))
} #Vemos un resumen de los niveles de cada variable categorica
for(i in vars_cat){#Vamos a poner NA's en los unknows
sel<-which(df[,i]=="unknown")
if(length(sel)>0) cat(i, " -- ", length(sel), "\n")
df[sel,i]<-NA
df[,i]<-factor(df[,i])
}
sel<-which(df$poutcome=="nonexistent")#Hacemos lo mismo con poutcome y sus nonexitent
print(length(sel))
df[sel,'poutcome']<-NA
df$poutcome<-factor(df$poutcome)
#no-target+categorica
for(i in vars_cat){
cat("################ ",i," ##################\n")
print(summary(df[,i]))
} #Vemos un resumen de los niveles de cada variable categorica
nb = estim_ncpMCA(df,ncp.max=5)
library(missMDA)
nb = estim_ncpMCA(df,ncp.max=5)
nb = estim_ncpMCA(df[,vars_cat],ncp.max=5)
dim(df[,vars_cat])
res.input<-imputeMCA(df$job,ncp=1)#No funciona
